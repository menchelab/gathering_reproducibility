import argparse as ap
import scanpy as sc
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

import logging
import umap
import gc
import os

from arboreto.utils import load_tf_names
from arboreto.algo import grnboost2

from ctxcore.rnkdb import FeatherRankingDatabase as RankingDatabase
from pyscenic.utils import modules_from_adjacencies
from pyscenic.prune import prune2df, df2regulons
from pyscenic.aucell import aucell
from distributed import Client, LocalCluster


success_message = '''
........................................................................................................................................
..........................:=.........-........==-.................................:.....#%..........+.........*.........................
.............................-..:......:..........-...@...:-.....@@@@@@@+.....:.......:....:...........:................................
...............................................................@@@*...=+@@#.............................................................
........................::-................:..:......:...:...=@@+::-@=+..+@@..........=:.....:..............:.................+.........
.-...............................#@=.....-....:.:.....+=.....@@=--#*@*#=#:+@-.-*-::......=.....*......@#..............................+.
...................................@@#@+...............+.....%@=:-+=#*+-=.:@:.....=.:...........@%*.*@#.................................
.................@.-#...............:#@.........%@......:.+.%@@@+.::=+-:+=@@@@@@@-.....#@.........=@@.........:......-..................
.....................*......::.....#-..@@-.................=@.+@..=#+=#+:.@..@....#@@.....:.....@@+#@*..............@...................
..............:..............:...@:......:=.....-..*..-::...@.%@..*#@=+=+.@..@.:-+#*..@@.......%@.=...=@....@@@.........................
...............................-...........:..::.=..-....:+#@..+....@.:...:.@@=..=-......@...-*...=..........:..........................
........................-...:......:........++:..--...+=-....*@...*.@.=...*@%=.:#+....-....@%...........................................
..................:.....-@@#:.............=:..-+...=-..:..-::-#-++++@##:..%#@%#@...@*....*+.=@.......%%:....*@@@-.......................
........-..............:...:.........@..-+..-....%=.....-.::..=@:-.=:.+..%@-..+.*@+...@....-.-@....@:...........@@.............-........
.......................................=--+....*...=++-.:-..+@@@=..*@@*..#@@@#.....+%:*#@...%..@........................................
......................................#:......=...-::....**#....-.=*@@+.+....@@@:..:+@@-.+=......%.......%..............................
.................................=%*.+...=..==.-:=...%@*@#......@...@=..@.-.....@@@@=..:......:@.:@..+@@....:...........................
....................................:=......*-:=:.%*@@@@*.....#*:.+.+:#.:*@.=.#.:#@@-.#@@...=:....:@......*.............................
............................+-..:-:=#=-#:--......*@.....=@@@=@=+.#+*@@*#--*@##@@*...#@@..=...+.-#-:@+......%............................
...................................=......-:+@#+@.....::=%-@+-.:::=@@@%.+*-=+@+*@.=.....@=@#.==..+.%@......:...%....:...................
..................................*-...........@-.=.-..*:=@:%@-+.-@#@+@=.::@@=+%%....--.@%@-..@.....=..@@.....................@.........
..................................:...........@...:..@+..+%++%+..+:.@:.*..*%+=-%..-@%.--..@:..:::.:..=..................................
.=-.......:................:......=........:-@@......-#+:=*+...@=*+-+.=#:@=..:@.=**........@+..-..:..=..=...*................=.......+..
.%:.+-@@+.........................=:.*=+@+=+#@@.:%@@@@#.@@@@%##@@@@:%-#@@@*+@@@@@.=@@@%@-.=@=..%::=.:=..........................-.+#....
.....-:...........................*::-..#....@....@%@@%@%@@@@##@@@@@%@@@@@#+%@@@@@@@@@@=*.=@=..-..:..-..........................*#+:....
..+...............................+..-.:=.=@%@:...+....%%--..-=@=..=:-..-@=...+.#+....:...-@*=:=-.-..-........................:.........
..................................=:.-.::...*@..*@#.@+.%#*#*:**::#*-@-*%:+*#.-=++:-@@.*.=..#...=--+.-*......:...........................
..................................+-.-.....@@:..*%#+...@#-=-@@+*-=@#@%@==*+@@=-:+*#..+@=*..*=.:=....::.-=...............................
..................................:=.....-=@#..*-....%@@+@@%*==#=-%@@@%=-*==+#@@==*......-.+@.:-..:--=.............=....................
...................................+.+@#::@@..*.....@#+%:@=**+:-+#.+%=:*+--=+@*#+=@%-.-..-...#:--=-:=...:..==...........................
...................................@%-.:+@@..+=...@@..#@@:+=..:::.##+##-=--..*-=#@*.*.--..:..%:.:::-=...................................
................................**:.#..@@...#@...@%..@@%@=:....#+.=-#*=.++-:#=.+.@@#-*-..=+...:@-.:=.#@@................................
.....................................@@:...@@...@#.#@...@#.##@@+:.*@@@+=+*#+=+==+-..:=*%..-+=:..%=-:....................................
..................................=..@...@@@@-.@.#@:...+@*...*@%#=++*+=-+*%=...:%#.....@=..+--+:.@..................-...................
........................:...........@%..@*....@@...:-..+@*.=@-*%+::-::-...:#%.:..*.:::..@..==::-..@@..:.:...............................
.........................#=@....-..@:..@@....*@-+:..:::@*@.%@++..=.+%*==...:%=...*.::::..@:..=++%..@...-.....@#.........................
..................................+#..*.....@%.-..%:...@=....-@*++::%.:-=..+.=...=...:::..@-.....:..@.--...=............................
.............................:.:.%....:...@@:..:::.=-*-@-#.:.#=.+=@-#:*.=-=:.:-..+@+.:.:-..-@+:...*..:...-..............................
..........................:.....:@:.....@@...*=::::...*@++...:.**.:.#+:.:...:.:-.#@:.+:::-==:=@+..-..-@=................................
....................@*.........:@..%@.@@@.:...-=-...=:@+....*=#*+.:#:-=:-*=:.-....*%-:.::-.....@@=+==+%%................................
...................::.....%+..#@.=..=@@-...:....=@#*..*=-:+*-*....+*##:...**-=:.#..::-+@=..-.=...@=+=..*#..........::...................
.............................@:...+@@.:=@.....=-.....@@:...@+...%.+*--.-:....@:..@*@....-:-....--#@@@@*..@..............................
..................*.....-...@+:.%@@......#+...:.=--:.@@:....-*%.+.#*:#-..=@:.:...-%@.:--=..-...%....@#+@..@..........................=@.
.....................=-..=@@:=*#@@.........+:.+..-::.@......=-..*.@:@=..-:+-=......@.::-.#+..+-......+=@@@.@%:-*:.......................
.........................@..@@=..-......=-:.-......=.%.:=-@..-=*=.@...=..#--..%-*:.@.=......:.:.......=..%@:.@..........................
........................+..@@..-@..::..-..:..=@..++..@*.:.@@..:.....:--...-..@@.-==@..*-.:*%.....:.:..@..:%@-.-.........................
.........-.............%=@@+..@%....+@.=......*@@....%@....+..++=:@....-+#+:..:..-.%....@@:....+.-.@...%@..**@%@*......-........-.......
...............-+.....@#@+..@...%-.....-+-:..#=.@@...%..-+........-*-@-.......#-+..+=..@%%*...:=.......@:@...-+@@+......#...=.@*........
.........:+*@=:-.....@+#...@...-..-+......=+.....-+..@.:=-*..:.:..@@.@@.....:.-.*+.==.+-....*=......--....-@....+@@:.......+@-%.........
...........=@*:-@..-.@..@@@...........@@@....:.....-*:.+..-..-.....@.*+..+-...:..=.:=+.........+@+*....:....@.@...*%-.=:#-@@@*..........
........=-..-.:...@@:@.*%..........++=.=............@:....+..=.-...@+@...=-.-.:..:.:#:...:..:....*=%=.......%*=@:.@=-@#:+-..@...........
............=...@-.........--.+=...........:.+*.....+-..-.#....+...%-@...:..=.#..-..*=...:*=............--.....=.-@..:=%@=..=...........
...........:*-@@.:.@=:*-%#:.........#.........+.+=..+...*.*....*-..@@#..-=..=.-..+..+=.*:%....................=%@..==*.#@@..@...........
..............:..:+.:@+...................%#....:..:#...-:..+...-.:%::@.:::....-=...+:..-....%-...................**.-..:#@-:%.=........
..........+%..+::..@=@@-==..........=%-........:...-@...-.@....-..@..:@.....-.%-:...=-............--....:......+*@@@@@:@*:..............
.........:--..........--*@:.....................-.:*#...-.@.+..:..@#@.@..:...--.....=*........................:+..*.........:=@:........
.......-+.........-........*=.*........=........@..-@.....@.@@=..@@.@-@#..%*..:.....+=.*........:............-.......=..........#+......
.....+*........:..-..........:..*................=.:%.........=*.*@@@@#@.=....@.....@#-................+...-:...................=.......
....-.............=...........=-:-.................-@@..:..=....@@.+-=+@-.....*.....@#....................:........................*....
.................................=:-=@%=..........-=#-..@..+...@@++..:+.@*....@.:...@*............-..::.................................
.................................-.....=@@%*+-......*......*:@.#@.-@=%.#@=*@:.+.....*.:....-+=:+-:...*..................................
............:............:................:+=--.:#:.%@..#=@%....*+#..@...-...@*=...@@-=%..::.=..........................................
.....................:......%.................-*@..:@@=#....@#==....@....@-#.@.#:+.@%::##+=.............................................
........+....::=.............:......................@..=....@@@@@@@%@%@@@@@#%*.+.=..%*#.................................................
.....:..............................................%::@*#*........:@....=...=.@++=.@:............................................-:....
..................+=................................@....%@@*:.=..#..#....+.*%@*....@-..................................................
..................=:..........:..................=*-@@......@:@@=.*@%#..@@=@.......:@=++:...............................................
.......:=.......=.............:.....................@=..:.:...@..=....+:.:@....+....@:...-..............................................
...................+...............................%@....%....:...:.....-...........+@.................@@............:..................
...................................................@+....=.+.%:@@:=@@-.@@..+.........@..:...............................................
...................................................@.....%.+.#....@+%%-....@..-......%*.................................................
.............................-.....-...............@...::-.:..=.@==.=.+@=.:+..:.......#.................................................
.........:........................................=@..-..:.:..#....@@:.=..-:.....::...%...............................:.................
........................................................................................................................................
'''

print(success_message)
